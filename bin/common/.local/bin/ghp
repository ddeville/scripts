#!/bin/bash

set -eu -o pipefail

BASE=$(git symbolic-ref --quiet --short refs/remotes/origin/HEAD | sed 's@^origin/@@')
# BASE=$(git symbolic-ref refs/remotes/origin/HEAD 2>/dev/null | sed 's@^refs/remotes/origin/@@')
HEAD=$(git branch --show-current)

gh pr create --base="$BASE" --head="$HEAD" --fill

URL=$(gh pr view "$HEAD" --json url -q .url)
open "$URL" 2>/dev/null
